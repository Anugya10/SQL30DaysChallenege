create table practice.salaries (
emp_name varchar(50),
department varchar (50),
salary int,
primary key (emp_name, department)
);

insert into practice.salaries values 
('Kathy', 'Engineering', 50000),
('Roy', 'Marketing', 30000),
('Charles', 'Engineering', 45000),
('Jack', 'Engineering', 85000),
('Benjamin', 'Marketing', 34000),
('Anthony', 'Marketing', 42000),
('Edward', 'Engineering', 102000),
('Terry', 'Engineering', 44000),
('Evelyn', 'Marketing', 53000),
('Arthur', 'Engineering', 32000);

select * from practice.salaries;

/* Write an SQL query to calculate the difference between the highest salaries in the marketing and engineering 
department. Output the absolute difference in salaries.*/

with CTE as (
     select department, max(pm.salary) as highest_salary
     from practice.salaries pm
     where department = 'Marketing'
     group by department
union all
     select department, max(pe.salary) as highest_salary
     from practice.salaries pe
     where department = 'Engineering'
     group by department)
select abs(
    max(case when department = 'Marketing' then highest_salary end) -
    max(case when department = 'Engineering' then highest_salary end)
) as salary_difference
from CTE;


select 
abs(
    max(case when department = 'Marketing' then salary end) -
    max(case when department = 'Engineering' then salary end)
) as salary_difference
from practice.salaries;